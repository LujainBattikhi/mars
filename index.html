<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mars ðŸ’•</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(135deg, #ff9ecf, #ffc7e3, #ffe4f2);
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  text-align: center;
}

/* Main Card */
.container {
  background: rgba(255,255,255,0.35);
  padding: 45px;
  border-radius: 30px;
  backdrop-filter: blur(20px);
  box-shadow: 0 20px 50px rgba(255,105,180,0.3);
  color: #c2185b;
  max-width: 440px;
  position: relative;
}

button {
  padding: 12px 28px;
  font-size: 16px;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  margin: 8px;
}

#yesBtn {
  background: white;
  color: #ff4da6;
  font-weight: 600;
}

#noBtn {
  background: #ff4da6;
  color: white;
  position: absolute;
  right: 0;
  transition: left 0.15s ease, top 0.15s ease;
}

#loveScreen {
  position: fixed;
  inset: 0;
  background: linear-gradient(135deg, #ff4da6, #ff85c1);
  display: none;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  color: white;
  padding: 22px;
  gap: 14px;
}

#openingScreen {
  position: fixed;
  inset: 0;
  background: linear-gradient(135deg, #ff9ecf, #ffc7e3, #ffe4f2);
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  color: #c2185b;
  z-index: 1000;
  cursor: pointer;
}

#mainCard { display: none; }

.photoWrap {
  width: min(72vw, 320px);
  border-radius: 22px;
  overflow: hidden;
  box-shadow: 0 18px 50px rgba(0,0,0,0.25);
}
.photoWrap img {
  width: 100%;
}
</style>
</head>

<body>

<!-- AUDIO (NO AUTOPLAY, NO PRELOAD) -->
<audio id="heartbeatAudio" src="heartbeat.mp3" loop preload="none"></audio>
<audio id="noAudio" src="no.mp3" preload="none"></audio>
<audio id="yesAudio" src="yes.mp3" preload="none"></audio>

<div id="openingScreen">
  <h2>Hi.. Mars ðŸ’—</h2>
  <p id="openingText">I made this for youâ€¦ click to start ðŸ’Œ</p>
</div>

<div class="container" id="mainCard">
  <h1>Mars ðŸ’•</h1>
  <div>
    You make things brighter without even trying.<br><br>
    Soâ€¦ will you be my Valentine? ðŸ’–
  </div>
  <div style="position:relative; margin-top:20px;">
    <button id="yesBtn">Yes ðŸ’–</button>
    <button id="noBtn">No ðŸ˜¢</button>
  </div>
</div>

<div id="loveScreen">
  <h2>ðŸ’— I love you ðŸ’—</h2>
  <div class="photoWrap">
    <img src="baby.jpg" alt="baby photo">
  </div>
  <p>I canâ€™t wait for more Valentineâ€™s together. ðŸ’ž</p>
</div>

<script>
const openingScreen = document.getElementById("openingScreen");
const mainCard = document.getElementById("mainCard");
const openingText = document.getElementById("openingText");
const yesBtn = document.getElementById("yesBtn");
const noBtn = document.getElementById("noBtn");

const heartbeat = document.getElementById("heartbeatAudio");
const noSound = document.getElementById("noAudio");
const yesSound = document.getElementById("yesAudio");

let heartbeatStarted = false;
let noPlaying = false;
let noLocked = false;

/* STOP ALL AUDIO ON LOAD */
window.addEventListener("load", () => {
  heartbeat.pause();
  noSound.pause();
  yesSound.pause();
});

/* OPENING SCREEN */
openingScreen.addEventListener("click", () => {

  if (!heartbeatStarted) {
    heartbeat.currentTime = 0;
    heartbeat.play().catch(()=>{});
    heartbeatStarted = true;
    openingText.textContent = "Okayâ€¦ one more click ðŸ’•";
    return;
  }

  openingScreen.style.display = "none";
  mainCard.style.display = "block";
});

/* PROXIMITY */
function checkProximity(x, y) {

  if (!document.body.contains(noBtn)) return;

  const noRect = noBtn.getBoundingClientRect();
  const yesRect = yesBtn.getBoundingClientRect();

  const noDist = Math.hypot(
    x - (noRect.left + noRect.width/2),
    y - (noRect.top + noRect.height/2)
  );

  const yesDist = Math.hypot(
    x - (yesRect.left + yesRect.width/2),
    y - (yesRect.top + yesRect.height/2)
  );

  if (yesDist < noDist) {
    if (noPlaying) {
      noSound.pause();
      noSound.currentTime = 0;
      noPlaying = false;
    }
    return;
  }

  if (noDist < 100) {
    if (!noPlaying) {
      noSound.currentTime = 0;
      noSound.play().catch(()=>{});
      noPlaying = true;
    }
  } else {
    if (noPlaying) {
      noSound.pause();
      noSound.currentTime = 0;
      noPlaying = false;
    }
  }
}

document.addEventListener("mousemove", e => {
  checkProximity(e.clientX, e.clientY);
});

document.addEventListener("touchmove", e => {
  const t = e.touches[0];
  checkProximity(t.clientX, t.clientY);
});

/* MOVE NO BUTTON */
function moveNo() {

const container = document.getElementById("mainCard");
const containerRect = container.getBoundingClientRect();

if (!noLocked) {
  const rect = noBtn.getBoundingClientRect();
  noBtn.style.width = rect.width + "px";
  noBtn.style.height = rect.height + "px";
  noLocked = true;
}

noBtn.style.position = "absolute";
noBtn.style.right = "auto";   // IMPORTANT
noBtn.style.zIndex = "5";

const rect = noBtn.getBoundingClientRect();

const maxX = container.clientWidth - rect.width - 10;
const maxY = container.clientHeight - rect.height - 10;

const x = Math.random() * maxX;
const y = Math.random() * maxY;

noBtn.style.left = x + "px";
noBtn.style.top  = y + "px";
}

noBtn.addEventListener("mouseover", moveNo);
noBtn.addEventListener("touchstart", moveNo);

/* YES CLICK */
yesBtn.addEventListener("click", () => {

  heartbeat.pause();
  heartbeat.currentTime = 0;

  if (noPlaying) {
    noSound.pause();
    noSound.currentTime = 0;
    noPlaying = false;
  }

  if (noBtn) noBtn.remove();

  yesSound.currentTime = 0;
  yesSound.play().catch(()=>{});

  mainCard.style.display = "none";
  document.getElementById("loveScreen").style.display = "flex";
});
</script>

</body>
</html>
